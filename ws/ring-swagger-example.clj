;; gorilla-repl.fileformat = 1

;; **
;;; # Ring Swagger Example
;;; 
;;; Welcome to gorilla :-)
;;; 
;;; Shift + enter evaluates code. Hit alt+g twice in quick succession or click the menu icon (upper-right corner) for more commands ...
;;; 
;;; It's a good habit to run each worksheet in its own namespace: feel free to use the declaration we've provided below if you'd like.
;; **

;; @@
(ns ring-swagger-example
  (:require [ring.swagger.swagger2 :as rs])
  (:require [schema.core :as s])
  (:use ring.adapter.jetty
        [ring.middleware.content-type]
        [ring.middleware.cookies]
        [ring.middleware.params]
        [ring.middleware.session]
        [ring.middleware.session.cookie]
        [ring.util.response]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(rs/swagger-json {})
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:swagger</span>","value":":swagger"},{"type":"html","content":"<span class='clj-string'>&quot;2.0&quot;</span>","value":"\"2.0\""}],"value":"[:swagger \"2.0\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:info</span>","value":":info"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:title</span>","value":":title"},{"type":"html","content":"<span class='clj-string'>&quot;Swagger API&quot;</span>","value":"\"Swagger API\""}],"value":"[:title \"Swagger API\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:version</span>","value":":version"},{"type":"html","content":"<span class='clj-string'>&quot;0.0.1&quot;</span>","value":"\"0.0.1\""}],"value":"[:version \"0.0.1\"]"}],"value":"{:title \"Swagger API\", :version \"0.0.1\"}"}],"value":"[:info {:title \"Swagger API\", :version \"0.0.1\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:produces</span>","value":":produces"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;application/json&quot;</span>","value":"\"application/json\""}],"value":"[\"application/json\"]"}],"value":"[:produces [\"application/json\"]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:consumes</span>","value":":consumes"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;application/json&quot;</span>","value":"\"application/json\""}],"value":"[\"application/json\"]"}],"value":"[:consumes [\"application/json\"]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:paths</span>","value":":paths"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[],"value":"{}"}],"value":"[:paths {}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:definitions</span>","value":":definitions"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[],"value":"{}"}],"value":"[:definitions {}]"}],"value":"{:swagger \"2.0\", :info {:title \"Swagger API\", :version \"0.0.1\"}, :produces [\"application/json\"], :consumes [\"application/json\"], :paths {}, :definitions {}}"}
;; <=

;; @@
(s/defschema User {:id s/Str,
                   :name s/Str
                   :address {:street s/Str
                             :city (s/enum :tre :hki)}})
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ring-swagger-example/User</span>","value":"#'ring-swagger-example/User"}
;; <=

;; @@
(s/with-fn-validation
  (rs/swagger-json
    {:info {:version "1.0.0"
            :title "Sausages"
            :description "Sausage description"
            :termsOfService "http://helloreverb.com/terms/"
            :contact {:name "My API Team"
                      :email "foo@example.com"
                      :url "http://www.metosin.fi"}
            :license {:name "Eclipse Public License"
                      :url "http://www.eclipse.org/legal/epl-v10.html"}}
     :tags [{:name "user"
             :description "User stuff"}]
     :paths {"/api/ping" {:get {}}
             "/user/:id" {:post {:summary "User Api"
                                  :description "User Api description"
                                  :tags ["user"]
                                  :parameters {:path {:id s/Str}
                                               :body User}
                                  :responses {200 {:schema User
                                                   :description "Found it!"}
                                              404 {:description "Ohnoes."}}}}}}))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:swagger</span>","value":":swagger"},{"type":"html","content":"<span class='clj-string'>&quot;2.0&quot;</span>","value":"\"2.0\""}],"value":"[:swagger \"2.0\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:info</span>","value":":info"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:title</span>","value":":title"},{"type":"html","content":"<span class='clj-string'>&quot;Sausages&quot;</span>","value":"\"Sausages\""}],"value":"[:title \"Sausages\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:version</span>","value":":version"},{"type":"html","content":"<span class='clj-string'>&quot;1.0.0&quot;</span>","value":"\"1.0.0\""}],"value":"[:version \"1.0.0\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;Sausage description&quot;</span>","value":"\"Sausage description\""}],"value":"[:description \"Sausage description\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:termsOfService</span>","value":":termsOfService"},{"type":"html","content":"<span class='clj-string'>&quot;http://helloreverb.com/terms/&quot;</span>","value":"\"http://helloreverb.com/terms/\""}],"value":"[:termsOfService \"http://helloreverb.com/terms/\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:contact</span>","value":":contact"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"html","content":"<span class='clj-string'>&quot;My API Team&quot;</span>","value":"\"My API Team\""}],"value":"[:name \"My API Team\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:email</span>","value":":email"},{"type":"html","content":"<span class='clj-string'>&quot;foo@example.com&quot;</span>","value":"\"foo@example.com\""}],"value":"[:email \"foo@example.com\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:url</span>","value":":url"},{"type":"html","content":"<span class='clj-string'>&quot;http://www.metosin.fi&quot;</span>","value":"\"http://www.metosin.fi\""}],"value":"[:url \"http://www.metosin.fi\"]"}],"value":"{:name \"My API Team\", :email \"foo@example.com\", :url \"http://www.metosin.fi\"}"}],"value":"[:contact {:name \"My API Team\", :email \"foo@example.com\", :url \"http://www.metosin.fi\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:license</span>","value":":license"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"html","content":"<span class='clj-string'>&quot;Eclipse Public License&quot;</span>","value":"\"Eclipse Public License\""}],"value":"[:name \"Eclipse Public License\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:url</span>","value":":url"},{"type":"html","content":"<span class='clj-string'>&quot;http://www.eclipse.org/legal/epl-v10.html&quot;</span>","value":"\"http://www.eclipse.org/legal/epl-v10.html\""}],"value":"[:url \"http://www.eclipse.org/legal/epl-v10.html\"]"}],"value":"{:name \"Eclipse Public License\", :url \"http://www.eclipse.org/legal/epl-v10.html\"}"}],"value":"[:license {:name \"Eclipse Public License\", :url \"http://www.eclipse.org/legal/epl-v10.html\"}]"}],"value":"{:title \"Sausages\", :version \"1.0.0\", :description \"Sausage description\", :termsOfService \"http://helloreverb.com/terms/\", :contact {:name \"My API Team\", :email \"foo@example.com\", :url \"http://www.metosin.fi\"}, :license {:name \"Eclipse Public License\", :url \"http://www.eclipse.org/legal/epl-v10.html\"}}"}],"value":"[:info {:title \"Sausages\", :version \"1.0.0\", :description \"Sausage description\", :termsOfService \"http://helloreverb.com/terms/\", :contact {:name \"My API Team\", :email \"foo@example.com\", :url \"http://www.metosin.fi\"}, :license {:name \"Eclipse Public License\", :url \"http://www.eclipse.org/legal/epl-v10.html\"}}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:produces</span>","value":":produces"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;application/json&quot;</span>","value":"\"application/json\""}],"value":"[\"application/json\"]"}],"value":"[:produces [\"application/json\"]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:consumes</span>","value":":consumes"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;application/json&quot;</span>","value":"\"application/json\""}],"value":"[\"application/json\"]"}],"value":"[:consumes [\"application/json\"]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:tags</span>","value":":tags"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"html","content":"<span class='clj-string'>&quot;user&quot;</span>","value":"\"user\""}],"value":"[:name \"user\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;User stuff&quot;</span>","value":"\"User stuff\""}],"value":"[:description \"User stuff\"]"}],"value":"{:name \"user\", :description \"User stuff\"}"}],"value":"[{:name \"user\", :description \"User stuff\"}]"}],"value":"[:tags [{:name \"user\", :description \"User stuff\"}]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:paths</span>","value":":paths"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;/api/ping&quot;</span>","value":"\"/api/ping\""},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:get</span>","value":":get"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:responses</span>","value":":responses"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:default</span>","value":":default"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;&quot;</span>","value":"\"\""}],"value":"[:description \"\"]"}],"value":"{:description \"\"}"}],"value":"[:default {:description \"\"}]"}],"value":"{:default {:description \"\"}}"}],"value":"[:responses {:default {:description \"\"}}]"}],"value":"{:responses {:default {:description \"\"}}}"}],"value":"[:get {:responses {:default {:description \"\"}}}]"}],"value":"{:get {:responses {:default {:description \"\"}}}}"}],"value":"[\"/api/ping\" {:get {:responses {:default {:description \"\"}}}}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;/user/{id}&quot;</span>","value":"\"/user/{id}\""},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:post</span>","value":":post"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:summary</span>","value":":summary"},{"type":"html","content":"<span class='clj-string'>&quot;User Api&quot;</span>","value":"\"User Api\""}],"value":"[:summary \"User Api\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;User Api description&quot;</span>","value":"\"User Api description\""}],"value":"[:description \"User Api description\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:tags</span>","value":":tags"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;user&quot;</span>","value":"\"user\""}],"value":"[\"user\"]"}],"value":"[:tags [\"user\"]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:parameters</span>","value":":parameters"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:in</span>","value":":in"},{"type":"html","content":"<span class='clj-string'>&quot;path&quot;</span>","value":"\"path\""}],"value":"[:in \"path\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"html","content":"<span class='clj-string'>&quot;id&quot;</span>","value":"\"id\""}],"value":"[:name \"id\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;&quot;</span>","value":"\"\""}],"value":"[:description \"\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:required</span>","value":":required"},{"type":"html","content":"<span class='clj-unkown'>true</span>","value":"true"}],"value":"[:required true]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;string&quot;</span>","value":"\"string\""}],"value":"[:type \"string\"]"}],"value":"{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:in</span>","value":":in"},{"type":"html","content":"<span class='clj-string'>&quot;body&quot;</span>","value":"\"body\""}],"value":"[:in \"body\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"html","content":"<span class='clj-string'>&quot;User&quot;</span>","value":"\"User\""}],"value":"[:name \"User\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;&quot;</span>","value":"\"\""}],"value":"[:description \"\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:required</span>","value":":required"},{"type":"html","content":"<span class='clj-unkown'>true</span>","value":"true"}],"value":"[:required true]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:schema</span>","value":":schema"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:$ref</span>","value":":$ref"},{"type":"html","content":"<span class='clj-string'>&quot;#/definitions/User&quot;</span>","value":"\"#/definitions/User\""}],"value":"[:$ref \"#/definitions/User\"]"}],"value":"{:$ref \"#/definitions/User\"}"}],"value":"[:schema {:$ref \"#/definitions/User\"}]"}],"value":"{:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}"}],"value":"[{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}]"}],"value":"[:parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}]]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:responses</span>","value":":responses"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>200</span>","value":"200"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:schema</span>","value":":schema"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:$ref</span>","value":":$ref"},{"type":"html","content":"<span class='clj-string'>&quot;#/definitions/User&quot;</span>","value":"\"#/definitions/User\""}],"value":"[:$ref \"#/definitions/User\"]"}],"value":"{:$ref \"#/definitions/User\"}"}],"value":"[:schema {:$ref \"#/definitions/User\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;Found it!&quot;</span>","value":"\"Found it!\""}],"value":"[:description \"Found it!\"]"}],"value":"{:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}"}],"value":"[200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>404</span>","value":"404"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:description</span>","value":":description"},{"type":"html","content":"<span class='clj-string'>&quot;Ohnoes.&quot;</span>","value":"\"Ohnoes.\""}],"value":"[:description \"Ohnoes.\"]"}],"value":"{:description \"Ohnoes.\"}"}],"value":"[404 {:description \"Ohnoes.\"}]"}],"value":"{200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}"}],"value":"[:responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}]"}],"value":"{:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}"}],"value":"[:post {:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}]"}],"value":"{:post {:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}}"}],"value":"[\"/user/{id}\" {:post {:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}}]"}],"value":"{\"/api/ping\" {:get {:responses {:default {:description \"\"}}}}, \"/user/{id}\" {:post {:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}}}"}],"value":"[:paths {\"/api/ping\" {:get {:responses {:default {:description \"\"}}}}, \"/user/{id}\" {:post {:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}}}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:definitions</span>","value":":definitions"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;User&quot;</span>","value":"\"User\""},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;object&quot;</span>","value":"\"object\""}],"value":"[:type \"object\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:properties</span>","value":":properties"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:id</span>","value":":id"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;string&quot;</span>","value":"\"string\""}],"value":"[:type \"string\"]"}],"value":"{:type \"string\"}"}],"value":"[:id {:type \"string\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;string&quot;</span>","value":"\"string\""}],"value":"[:type \"string\"]"}],"value":"{:type \"string\"}"}],"value":"[:name {:type \"string\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:address</span>","value":":address"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:$ref</span>","value":":$ref"},{"type":"html","content":"<span class='clj-string'>&quot;#/definitions/UserAddress&quot;</span>","value":"\"#/definitions/UserAddress\""}],"value":"[:$ref \"#/definitions/UserAddress\"]"}],"value":"{:$ref \"#/definitions/UserAddress\"}"}],"value":"[:address {:$ref \"#/definitions/UserAddress\"}]"}],"value":"{:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}"}],"value":"[:properties {:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:additionalProperties</span>","value":":additionalProperties"},{"type":"html","content":"<span class='clj-unkown'>false</span>","value":"false"}],"value":"[:additionalProperties false]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:required</span>","value":":required"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:id</span>","value":":id"},{"type":"html","content":"<span class='clj-keyword'>:name</span>","value":":name"},{"type":"html","content":"<span class='clj-keyword'>:address</span>","value":":address"}],"value":"[:id :name :address]"}],"value":"[:required [:id :name :address]]"}],"value":"{:type \"object\", :properties {:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}, :additionalProperties false, :required [:id :name :address]}"}],"value":"[\"User\" {:type \"object\", :properties {:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}, :additionalProperties false, :required [:id :name :address]}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-string'>&quot;UserAddress&quot;</span>","value":"\"UserAddress\""},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;object&quot;</span>","value":"\"object\""}],"value":"[:type \"object\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:properties</span>","value":":properties"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:street</span>","value":":street"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;string&quot;</span>","value":"\"string\""}],"value":"[:type \"string\"]"}],"value":"{:type \"string\"}"}],"value":"[:street {:type \"string\"}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:city</span>","value":":city"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:type</span>","value":":type"},{"type":"html","content":"<span class='clj-string'>&quot;string&quot;</span>","value":"\"string\""}],"value":"[:type \"string\"]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:enum</span>","value":":enum"},{"type":"html","content":"<span class='clj-unkown'>(:tre :hki)</span>","value":"(:tre :hki)"}],"value":"[:enum (:tre :hki)]"}],"value":"{:type \"string\", :enum (:tre :hki)}"}],"value":"[:city {:type \"string\", :enum (:tre :hki)}]"}],"value":"{:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}"}],"value":"[:properties {:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:additionalProperties</span>","value":":additionalProperties"},{"type":"html","content":"<span class='clj-unkown'>false</span>","value":"false"}],"value":"[:additionalProperties false]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:required</span>","value":":required"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:street</span>","value":":street"},{"type":"html","content":"<span class='clj-keyword'>:city</span>","value":":city"}],"value":"[:street :city]"}],"value":"[:required [:street :city]]"}],"value":"{:type \"object\", :properties {:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}, :additionalProperties false, :required [:street :city]}"}],"value":"[\"UserAddress\" {:type \"object\", :properties {:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}, :additionalProperties false, :required [:street :city]}]"}],"value":"{\"User\" {:type \"object\", :properties {:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}, :additionalProperties false, :required [:id :name :address]}, \"UserAddress\" {:type \"object\", :properties {:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}, :additionalProperties false, :required [:street :city]}}"}],"value":"[:definitions {\"User\" {:type \"object\", :properties {:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}, :additionalProperties false, :required [:id :name :address]}, \"UserAddress\" {:type \"object\", :properties {:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}, :additionalProperties false, :required [:street :city]}}]"}],"value":"{:swagger \"2.0\", :info {:title \"Sausages\", :version \"1.0.0\", :description \"Sausage description\", :termsOfService \"http://helloreverb.com/terms/\", :contact {:name \"My API Team\", :email \"foo@example.com\", :url \"http://www.metosin.fi\"}, :license {:name \"Eclipse Public License\", :url \"http://www.eclipse.org/legal/epl-v10.html\"}}, :produces [\"application/json\"], :consumes [\"application/json\"], :tags [{:name \"user\", :description \"User stuff\"}], :paths {\"/api/ping\" {:get {:responses {:default {:description \"\"}}}}, \"/user/{id}\" {:post {:summary \"User Api\", :description \"User Api description\", :tags [\"user\"], :parameters [{:in \"path\", :name \"id\", :description \"\", :required true, :type \"string\"} {:in \"body\", :name \"User\", :description \"\", :required true, :schema {:$ref \"#/definitions/User\"}}], :responses {200 {:schema {:$ref \"#/definitions/User\"}, :description \"Found it!\"}, 404 {:description \"Ohnoes.\"}}}}}, :definitions {\"User\" {:type \"object\", :properties {:id {:type \"string\"}, :name {:type \"string\"}, :address {:$ref \"#/definitions/UserAddress\"}}, :additionalProperties false, :required [:id :name :address]}, \"UserAddress\" {:type \"object\", :properties {:street {:type \"string\"}, :city {:type \"string\", :enum (:tre :hki)}}, :additionalProperties false, :required [:street :city]}}}"}
;; <=

;; @@
;; Run the provided handler on port 3000 or given port
(defn run
  ([h] (run h 3000))
  ([h p] (run-jetty h {:port p :join? false})))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ring-swagger-example/run</span>","value":"#'ring-swagger-example/run"}
;; <=

;; @@
;; Handler that just echos back the string "Hello World"
(defn simple-handler [request]
  {:status 200
   :headers {"Content-Type" "text/plain"}
   :body "Hello World"})
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ring-swagger-example/simple-handler</span>","value":"#'ring-swagger-example/simple-handler"}
;; <=

;; @@
(def srv-simple-handler (run simple-handler))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ring-swagger-example/srv-simple-handler</span>","value":"#'ring-swagger-example/srv-simple-handler"}
;; <=

;; @@
(.stop srv-simple-handler)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(.start srv-simple-handler)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
;; Handler that echos back the clients IP Address
;; This demonstrates building responses properly, and extracting values from the request
(defn check-ip-handler [request]
    (content-type
        (response (:remote-addr request))
        "text/plain"))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ring-swagger-example/check-ip-handler</span>","value":"#'ring-swagger-example/check-ip-handler"}
;; <=

;; @@
(def srv-check-ip-handler (run check-ip-handler 3001))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;ring-swagger-example/srv-check-ip-handler</span>","value":"#'ring-swagger-example/srv-check-ip-handler"}
;; <=

;; @@
(.stop srv-check-ip-handler)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(.start srv-check-ip-handler)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@

;; @@
